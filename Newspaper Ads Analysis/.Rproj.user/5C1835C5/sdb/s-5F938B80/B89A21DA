{
    "contents" : "library(\"ggplot2\")\nlibrary(\"reshape2\")\nlibrary(\"stringr\")  # Library to strip the string\nlibrary(\"plyr\")\n\nns <- read.csv(\"NS.csv\")  # Reading the CSV\n\n# Computing Days with Number of News Pages\n\nnewsPages <- data.frame(ns$Date, ns$Full.Page.Ads, I(ns$Total.Pages - ns$Full.Page.Ads))\nnewsHeading <- c(\"Date\", \"FullPageAds\", \"NewsPages\")  # Renaming the columns\nnames(newsPages) <- newsHeading\nnewsPages2 <- melt(newsPages)\nggplot(data = newsPages2, aes(x = Date, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\") +\n  ylab(\"Number of Pages\") +\n  scale_fill_manual(values = c(\"#E24139\", \"#158504\"),\n                    name = \"Pages Composition\",\n                    breaks = c(\"FullPageAds\", \"NewsPages\"),\n                    labels = c(\"Full Page Ads\", \"Pages with News\")) +\n  theme(panel.background = element_blank()) + # No background\n  coord_flip()\n\n# Companies mostly taking the front page\n\ncompanies <- ns$Front.Page.Ad.By  # Getting all the companies\ncompanies2 <- strsplit(as.character(companies), \",\", fixed=TRUE)  # Splitting the Companies\n\nallCompanies <- vector(mode=\"numeric\", 0)  # Empty Vector to store companies\n\n# Loop to get all the companies indivually \nfor (i in 1:length(companies2)){\n  for (o in 1:length(companies2[[i]])){\n    allCompanies <- c(allCompanies, str_trim(companies2[[i]][o]))\n  }\n}\n\nallCompanies <- data.frame(allCompanies)  # Converting to data frame\nallCompanies <- count(allCompanies, \"allCompanies\")  # Counting the number of companies\n\n# Making a new variable Bar Graph\ncname <- vector(mode = \"character\", length=0)\ncvalue <- vector(mode = \"integer\", length=0)\nfor (i in 1:nrow(allCompanies))\n{\n  if (allCompanies[i, 2] <= 1)\n  {\n    if (!('Others' %in% cname))\n    {\n      cname <- c(cname, 'Others')\n      cvalue[match('Others', cname)] = 1\n    }\n    else\n    {\n      cvalue[match('Others', cname)] = I(cvalue[match('Others', cname)] + 1)\n    }\n  }\n  else\n  {\n    cname <- c(cname, as.character(allCompanies[i, 1]))  # To get the company name\n    cvalue[match(allCompanies[i, 1], cname)] = allCompanies[i, 2]  # To get the value of its occurance\n  }\n}\n\nCompaniesCount <- data.frame(cname, cvalue)\nnames(CompaniesCount) <- c(\"CompanyName\", \"Occurrence\")\n\nggplot(data = CompaniesCount, aes(x = CompanyName, y = Occurrence)) + \n  scale_y_continuous(breaks = round(seq(0, max(15), by=2))) + \n  theme(panel.border=element_blank(), \n        panel.background=element_blank()) + \n  geom_bar(stat = \"identity\")\n\n",
    "created" : 1445775696824.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2891670489",
    "id" : "B89A21DA",
    "lastKnownWriteTime" : 1445796350,
    "path" : "~/Programming/Practice R/Newspaper Ads Analysis/Analysis.R",
    "project_path" : "Analysis.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}